#include <stdio.h>
#include <stdlib.h>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int count = 0;
struct node
{
    int f, s;
    struct node *next;

};

struct node *beg=NULL, *end=NULL, *i= NULL, *j= NULL, *k=NULL;
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void create_node(int f, int s)
{


    struct node *temp=(struct node*)malloc(sizeof(struct node));
    temp->f=f;
    temp->s=s;
    temp->next=NULL; //EXTREMELY IMPORTANT, DONT FORGET

    if(beg==NULL)
    {
        beg=temp;
        end=temp;
    }

    else{
        end->next=temp;
        end=temp;
    }

}
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void transit()
{   int c=0;
    for(i=beg;i!=NULL;i=i->next)                    //MAKING THE LIST TRANSITIVE
    for(j=beg;j!=NULL;j=j->next)
 {
     if(i->s==j->f)
     {
        c=0;
        for(k=beg; k!=NULL; k=k->next)
        {
            if((i->f==k->f)&&(j->s==k->s))
                c++;

        }

        if(c==0)
            create_node(i->f, j->s);
     }
 }


}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int check(int *a,int n)
{ int f1,s1,c=0;
    for(i=beg;i!=NULL;i=i->next)
    {
        for(f1=0;f1<n;f1++)
            if(a[f1]==i->f)
            break;



        for(s1=0;s1<n;s1++)
            if(a[s1]==i->s)
            break;



        if(f1>s1)
        {
        c=1; break;}


    }


    if(c==0)
        return 1;
    else
        return 0;
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void swap(int *a, int *b)
{
    int temp=*a;
    *a=*b;
    *b=temp;
}
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void permute(int *a, int l, int r)
{   int p;
    if(l==r)
    {


       if(check(a,r+1)==1)
        count++;



    }
    else
    {
        for(p=l;p<=r;p++)
        {
            swap(a+l,a+p);
            permute(a,l+1,r);
            swap(a+l,a+p);
        }
    }


}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
int main()
{
    int n, k1, f, s;
    scanf("%d %d", &n, &k);

    while(k1!=0)
    {   scanf("%d %d', &f, &s");
        create_node(f,s);
        k1--;
    }

    transit();
    printf("MADE TRANSISTIVE\n");

    int *b=(int *)malloc(n*sizeof(int));
    int p;
    for(p=0;p<n;p++)
    {
        b[p]=p;
    }

    permute(b,0,n-1);
    printf("%d\n",count);


}
